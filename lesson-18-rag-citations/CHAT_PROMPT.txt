# –ö—Ä–∞—Ç–∫–∏–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: üî• –î–µ–Ω—å 18. –¶–∏—Ç–∞—Ç—ã –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

–¢—ã ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —Å–æ–∑–¥–∞—é—â–∏–π —É—Ä–æ–∫ ¬´üî• –î–µ–Ω—å 18. –¶–∏—Ç–∞—Ç—ã –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏¬ª –≤ –º–æ–¥—É–ª–µ `lesson-18-rag-citations`. –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–µ–∫ **Kotlin + Ktor + Clean Architecture + SQLite** —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –Ω–∞ **vanilla JS**.

## –¶–µ–ª—å

–î–æ—Ä–∞–±–æ—Ç–∞—Ç—å RAG-—Å–∏—Å—Ç–µ–º—É —Ç–∞–∫, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ —Ü–∏—Ç–∞—Ç—ã –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏** –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –≤ –∫–∞–∂–¥–æ–º –æ—Ç–≤–µ—Ç–µ. –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å—Å—ã–ª–∫—É –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 5 –≤–æ–ø—Ä–æ—Å–∞—Ö –∏ –æ—Ü–µ–Ω–∏—Ç—å, —Å—Ç–∞–ª–æ –ª–∏ –º–µ–Ω—å—à–µ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π.

## –ö–ª—é—á–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞ 17** ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏–∑ `lesson-17-rag-reranking/` –≤ `lesson-18-rag-citations/`, –∑–∞–º–µ–Ω–∏–≤ –≤—Å–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è 17 –Ω–∞ 18
2. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ü–∏—Ç–∞—Ç—ã** ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç, —á—Ç–æ–±—ã LLM –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–ª –∏—Å—Ç–æ—á–Ω–∏–∫–∏
3. **–ü–∞—Ä—Å–∏–Ω–≥ —Ü–∏—Ç–∞—Ç** ‚Äî —Å–æ–∑–¥–∞—Ç—å `CitationParser` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫ –∏–∑ –æ—Ç–≤–µ—Ç–æ–≤
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ —Ü–∏—Ç–∞—Ç—ã —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
5. **–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** ‚Äî API endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
6. **UI –¥–ª—è —Ü–∏—Ç–∞—Ç** ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –≤ –æ—Ç–≤–µ—Ç–µ, –∫–ª–∏–∫ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç
7. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Ç–µ—Å—Ç–∞ –Ω–∞ 5 –≤–æ–ø—Ä–æ—Å–∞—Ö —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
8. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å README, THEORY, –¥–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –≤ –∫–æ—Ä–Ω–µ–≤–æ–π README

## –ü–æ—ç—Ç–∞–ø–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã)

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ö–∞–∂–¥—ã–π —à–∞–≥ = –æ—Ç–¥–µ–ª—å–Ω—ã–π git-–∫–æ–º–º–∏—Ç. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ **–°–¢–û–ü**, –ø–æ–∫–∞–∂–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –¥–æ–∂–¥–∏—Å—å ¬´–æ–∫, –ø—Ä–æ–¥–æ–ª–∂–∞–π¬ª.

### –ö–æ–º–º–∏—Ç 1: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞ 17
- –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –∫–æ–¥ –∏–∑ `lesson-17-rag-reranking/` –≤ `lesson-18-rag-citations/`
- –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è `lesson-17-rag-reranking` ‚Üí `lesson-18-rag-citations`
- –ó–∞–º–µ–Ω–∏—Ç—å ¬´–î–µ–Ω—å 17¬ª ‚Üí ¬´–î–µ–Ω—å 18¬ª
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

### –ö–æ–º–º–∏—Ç 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–∏—Ç–∞—Ç
- –û–±–Ω–æ–≤–∏—Ç—å `PromptBuilder` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑—ã–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- –§–æ—Ä–º–∞—Ç —Ü–∏—Ç–∞—Ç: `[–ò—Å—Ç–æ—á–Ω–∏–∫: –Ω–∞–∑–≤–∞–Ω–∏–µ_–¥–æ–∫—É–º–µ–Ω—Ç–∞](–ø—É—Ç—å_–∫_–¥–æ–∫—É–º–µ–Ω—Ç—É)`
- –í–∫–ª—é—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç

### –ö–æ–º–º–∏—Ç 3: –ü–∞—Ä—Å–µ—Ä —Ü–∏—Ç–∞—Ç –∏–∑ –æ—Ç–≤–µ—Ç–∞ LLM
- –°–æ–∑–¥–∞—Ç—å `CitationParser` (domain/service)
- –ú–æ–¥–µ–ª—å `Citation` (text, documentPath, documentTitle, chunkId, position)
- –ú–æ–¥–µ–ª—å `AnswerWithCitations` (answer, citations, rawAnswer)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (Markdown, –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ, –ø—Ä–æ—Å—Ç—ã–µ)

### –ö–æ–º–º–∏—Ç 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ü–∏—Ç–∞—Ç –≤ RAG-—Å–µ—Ä–≤–∏—Å
- –û–±–Ω–æ–≤–∏—Ç—å `RAGService` ‚Äî –ø–∞—Ä—Å–∏—Ç—å —Ü–∏—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
- –û–±–Ω–æ–≤–∏—Ç—å `RAGResponse` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `citations: List<Citation>`
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–∏—Ç–∞—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç—ã –±—ã–ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

### –ö–æ–º–º–∏—Ç 5: API –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –°–æ–∑–¥–∞—Ç—å `DocumentController` —Å endpoint `GET /api/documents/{documentPath}`
- –í–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –¥–∞—Ç–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Ç–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –ö–æ–º–º–∏—Ç 6: UI –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ü–∏—Ç–∞—Ç –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –û–±–Ω–æ–≤–∏—Ç—å `rag-compare.html` ‚Äî –ø–∞—Ä—Å–∏—Ç—å –æ—Ç–≤–µ—Ç –∏ –≤—ã–¥–µ–ª—è—Ç—å —Å—Å—ã–ª–∫–∏
- –°–æ–∑–¥–∞—Ç—å `document-viewer.html` ‚Äî –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- JavaScript: `citations.js`, `document-viewer.js`
- –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫ –∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞

### –ö–æ–º–º–∏—Ç 7: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
- –°–æ–∑–¥–∞—Ç—å `CitationAnalyzer` ‚Äî –∞–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–∏—Ç–∞—Ç
- API endpoint `POST /api/rag/test-citations` ‚Äî —Ç–µ—Å—Ç –Ω–∞ 5 –≤–æ–ø—Ä–æ—Å–∞—Ö
- –ú–æ–¥–µ–ª–∏: `CitationTestResult`, `CitationTestReport`, `CitationMetrics`
- UI: —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `citation-test.html` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–∞ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ö–æ–º–º–∏—Ç 8: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –≤—ã–≤–æ–¥—ã
- –û–±–Ω–æ–≤–∏—Ç—å `README.md`, `THEORY.md`, `PROMPT.md`, `CHAT_PROMPT.txt`
- –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª ¬´–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è¬ª —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –≤–∏–¥–µ–æ
- –û–ø–∏—Å–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤–ª–∏—è–Ω–∏–µ —Ü–∏—Ç–∞—Ç –Ω–∞ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏
- –û–±–Ω–æ–≤–∏—Ç—å –∫–æ—Ä–Ω–µ–≤–æ–π `README.md`, –¥–æ–±–∞–≤–∏–≤ —Å—Å—ã–ª–∫—É –Ω–∞ —É—Ä–æ–∫ 18

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§–æ—Ä–º–∞—Ç —Ü–∏—Ç–∞—Ç
- Markdown: `[–ò—Å—Ç–æ—á–Ω–∏–∫: –Ω–∞–∑–≤–∞–Ω–∏–µ](–ø—É—Ç—å)`
- –ù—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ: `[1] –Ω–∞–∑–≤–∞–Ω–∏–µ (–ø—É—Ç—å)`
- –ü—Ä–æ—Å—Ç—ã–µ: `–ò—Å—Ç–æ—á–Ω–∏–∫: –ø—É—Ç—å`

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç –±—ã–ª –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∑–∞–ø—Ä–æ—Å–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Ç–∏ (–Ω–µ—Ç `../`)

### –ú–µ—Ç—Ä–∏–∫–∏
- –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–≤–µ—Ç–æ–≤ —Å —Ü–∏—Ç–∞—Ç–∞–º–∏ (> 90%)
- –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏—Ç–∞—Ç –Ω–∞ –æ—Ç–≤–µ—Ç (> 2)
- –ü—Ä–æ—Ü–µ–Ω—Ç –≤–∞–ª–∏–¥–Ω—ã—Ö —Ü–∏—Ç–∞—Ç (> 95%)
- –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–≤–µ—Ç–æ–≤ –±–µ–∑ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π (> 80%)

## –¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã (5 —à—Ç—É–∫)

1. "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?"
2. "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ?"
3. "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥?"
4. "–ö–∞–∫ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —á–µ—Ä–µ–∑ Ollama?"
5. "–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —á–∞–Ω–∫–æ–≤?"

## –í–∞–∂–Ω–æ

- –ù–µ –ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑ —É—Ä–æ–∫–∞ 17
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –¥–µ–ª–∞–µ—Ç merge/commit
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

