# –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: üî• –î–µ–Ω—å 16. –ü–µ—Ä–≤—ã–π RAG-–∑–∞–ø—Ä–æ—Å

–¢—ã ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —Å–æ–∑–¥–∞—é—â–∏–π —É—Ä–æ–∫ ¬´üî• –î–µ–Ω—å 16. –ü–µ—Ä–≤—ã–π RAG-–∑–∞–ø—Ä–æ—Å¬ª –≤ –º–æ–¥—É–ª–µ `lesson-16-rag-query`. –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–µ–∫ **Kotlin + Ktor + Clean Architecture + SQLite** —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –Ω–∞ **vanilla JS**. 

## üéØ –¶–µ–ª—å —É—Ä–æ–∫–∞

–ü–æ–¥–∫–ª—é—á–∏—Ç—å RAG (Retrieval-Augmented Generation) –∫ LLM –∏ –ø–æ–Ω—è—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å RAG –∏ –±–µ–∑ RAG. –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞–Ω–∫–∏ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è LLM –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã —Å RAG –∏ –±–µ–∑ RAG.

### –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:

**RAG = –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π + –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ LLM** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Ö –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ OpenRouter, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç LLM –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

### –ü–∞–π–ø–ª–∞–π–Ω RAG-–∑–∞–ø—Ä–æ—Å–∞:

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å
   ‚Üì
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ (—á–µ—Ä–µ–∑ Ollama)
   ‚Üì
3. –ü–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π (–∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ)
   ‚Üì
4. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —á–∞–Ω–∫–æ–≤ –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π (–ø–æ–ª–µ content)
   ‚Üì
5. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏–∑ —á–∞–Ω–∫–æ–≤
   ‚Üì
6. –ó–∞–ø—Ä–æ—Å –∫ LLM —á–µ—Ä–µ–∑ OpenRouter —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (RAG-—Ä–µ–∂–∏–º)
   ‚Üì
7. –ó–∞–ø—Ä–æ—Å –∫ LLM —á–µ—Ä–µ–∑ OpenRouter –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º)
   ‚Üì
8. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –∏ –≤—ã–≤–æ–¥—ã
```

---

## üìã –ü–æ—ç—Ç–∞–ø–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã)

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** 
- –†–µ–∞–ª–∏–∑—É–π –ø–æ—à–∞–≥–æ–≤–æ, –∫–∞–∂–¥—ã–π —à–∞–≥ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π git –∫–æ–º–º–∏—Ç
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ **–û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ô–°–Ø** –∏ –ø–æ–∫–∞–∂–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –∫–æ–¥–æ–º –∏ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å —Å–∞–º
- **–ù–ï –ü–†–û–î–û–õ–ñ–ê–ô** –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∫–æ–º–º–∏—Ç—É –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ö–æ–º–º–∏—Ç 1: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —É—Ä–æ–∫–∞ 15

**–ó–∞–¥–∞—á–∞:** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–µ—Å—å –∫–æ–¥ –∏–∑ —É—Ä–æ–∫–∞ 15 –≤ —É—Ä–æ–∫ 16.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ `lesson-15-document-indexing/` –≤ `lesson-16-rag-query/`
2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã:
   - –í–µ—Å—å –∫–æ–¥ —Å–µ—Ä–≤–µ—Ä–∞ (`server/`)
   - –í–µ—Å—å –∫–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞ (`client/`)
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (`config/`)
   - –î–æ–∫—É–º–µ–Ω—Ç—ã (`documents/`)
   - –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã (README, THEORY –∏ —Ç.–¥.)
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤ —É—Ä–æ–∫–µ 15:
   - –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
   - UI –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–í–∞–∂–Ω–æ:**
- –ù–µ –º–µ–Ω—è—Ç—å –Ω–∏—á–µ–≥–æ –≤ –∫–æ–¥–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ
- –ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë –∫–∞–∫ –µ—Å—Ç—å
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–æ–º–º–∏—Ç–∞:** –û—Å—Ç–∞–Ω–æ–≤–∏—Å—å –∏ –ø–æ–∫–∞–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ –∫–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω. –î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∫–æ–º–º–∏—Ç–æ–º.

---

### –ö–æ–º–º–∏—Ç 2: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ OpenRouter –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å

**–ó–∞–¥–∞—á–∞:** –ü–æ–¥–∫–ª—é—á–∏—Ç—å OpenRouter (–∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É—Ä–æ–∫–∞—Ö) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç LLM –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. `OpenAIClient` ‚Äî –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å OpenRouter API
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ –ø–æ–¥—Ö–æ–¥, —á—Ç–æ –≤ —É—Ä–æ–∫–µ 14 (orchestration)
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ chat completions —á–µ—Ä–µ–∑ OpenRouter
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `config/server.yaml` –∏ `.env`

2. `LLMService` ‚Äî —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å LLM
   - –ú–µ—Ç–æ–¥ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
   - –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ OpenRouter –≤ `config/server.yaml`
   - –ú–æ–¥–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `config/server.yaml`
   - API –∫–ª—é—á –±–µ—Ä—ë—Ç—Å—è –∏–∑ `.env` –∫–∞–∫ `OPENAI_API_KEY`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
server/
‚îú‚îÄ‚îÄ src/main/kotlin/com/prike/
‚îÇ   ‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ OpenAIClient.kt  # –∫–ª–∏–µ–Ω—Ç –¥–ª—è OpenRouter
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ OpenAIRequest.kt
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ OpenAIResponse.kt
‚îÇ   ‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ service/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ LLMService.kt  # —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å LLM
‚îÇ   ‚îî‚îÄ‚îÄ config/
‚îÇ       ‚îî‚îÄ‚îÄ Config.kt  # –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é OpenRouter
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è OpenRouter (–∏–∑ —É—Ä–æ–∫–∞ 14):**
```kotlin
class OpenAIClient(
    private val apiKey: String,
    private val apiUrl: String = "https://openrouter.ai/api/v1/chat/completions",
    private val model: String,
    private val temperature: Double = 0.7,
    private val maxTokens: Int = 2000
) {
    suspend fun chatCompletion(
        messages: List<MessageDto>,
        temperature: Double = this.temperature
    ): OpenAIResponse {
        // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∫ OpenRouter
    }
}
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `config/server.yaml`:**
```yaml
ai:
  provider: "openrouter"
  apiKey: "${OPENAI_API_KEY}"  # –±–µ—Ä—ë—Ç—Å—è –∏–∑ .env
  model: "gpt-4o-mini"  # –∏–ª–∏ –¥—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å
  temperature: 0.7
  maxTokens: 2000
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `.env` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞):**
```
OPENAI_API_KEY=your_openrouter_api_key
```

**API Endpoint:**
```kotlin
POST /api/llm/chat
Body: {
    "question": "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?",
    "systemPrompt": "–¢—ã ‚Äî –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã."
}
Response: {
    "answer": "–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è MCP —Å–µ—Ä–≤–µ—Ä–∞ –Ω—É–∂–Ω–æ...",
    "tokensUsed": 150
}
```

**–í–∞–∂–Ω–æ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ –ø–æ–¥—Ö–æ–¥ –∫ OpenRouter, —á—Ç–æ –≤ —É—Ä–æ–∫–µ 14
- –ù–µ —Ç—Ä–æ–≥–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞
- –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å LLM

**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–æ–º–º–∏—Ç–∞:** –û—Å—Ç–∞–Ω–æ–≤–∏—Å—å –∏ –ø–æ–∫–∞–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–∑–º–µ–Ω–µ–Ω–∏—è. –î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∫–æ–º–º–∏—Ç–æ–º.

---

### –ö–æ–º–º–∏—Ç 3: RAG-—Å–µ—Ä–≤–∏—Å ‚Äî –ø–æ–∏—Å–∫ —á–∞–Ω–∫–æ–≤ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞

**–ó–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º.

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. `RAGService` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è RAG-–∑–∞–ø—Ä–æ—Å–æ–≤
   - –ü–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –ø–æ –≤–æ–ø—Ä–æ—Å—É
   - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏–∑ —á–∞–Ω–∫–æ–≤
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `KnowledgeBaseSearchService` (—É–∂–µ –µ—Å—Ç—å –∏–∑ —É—Ä–æ–∫–∞ 15)

2. `PromptBuilder` ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –ø—Ä–æ–º–ø—Ç–æ–≤
   - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏–∑ —á–∞–Ω–∫–æ–≤
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–Ω—É–º–µ—Ä–∞—Ü–∏—è, –∏—Å—Ç–æ—á–Ω–∏–∫–∏)
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –¥–ª—è LLM

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
server/
‚îú‚îÄ‚îÄ src/main/kotlin/com/prike/
‚îÇ   ‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RAGService.kt
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PromptBuilder.kt
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ model/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ RAGRequest.kt
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ RAGResponse.kt
```

**–ú–æ–¥–µ–ª—å RAGRequest:**
```kotlin
data class RAGRequest(
    val question: String,
    val topK: Int = 3,  // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    val minSimilarity: Float = 0.5f  // –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ
)
```

**–ú–æ–¥–µ–ª—å RAGResponse:**
```kotlin
data class RAGResponse(
    val question: String,
    val answer: String,
    val contextChunks: List<RetrievedChunk>,  // –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —á–∞–Ω–∫–∏
    val tokensUsed: Int? = null
)
```

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:**
```
–¢—ã ‚Äî –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π.

–ö–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π:

[–ß–∞–Ω–∫ 1] (–¥–æ–∫—É–º–µ–Ω—Ç: documents/01-mcp-server-creation.md, —Å—Ö–æ–¥—Å—Ç–≤–æ: 0.89)
–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä? –°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SDK...

[–ß–∞–Ω–∫ 2] (–¥–æ–∫—É–º–µ–Ω—Ç: documents/01-mcp-server-creation.md, —Å—Ö–æ–¥—Å—Ç–≤–æ: 0.76)
...—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SDK. –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å Server...

[–ß–∞–Ω–∫ 3] (–¥–æ–∫—É–º–µ–Ω—Ç: documents/02-embeddings-and-vector-search.md, —Å—Ö–æ–¥—Å—Ç–≤–æ: 0.65)
–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ollama...

–í–æ–ø—Ä–æ—Å: –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
- –û—Ç–≤–µ—á–∞–π —Ç–æ–ª—å–∫–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ï—Å–ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–≤–µ—Ç–∞, —Å–∫–∞–∂–∏ –æ–± —ç—Ç–æ–º
- –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤–∞, —É–∫–∞–∂–∏ –Ω–∞ —ç—Ç–æ

–û—Ç–≤–µ—Ç:
```

**–í–∞–∂–Ω–æ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `KnowledgeBaseSearchService` –∏–∑ —É—Ä–æ–∫–∞ 15
- –ù–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–∏—Å–∫–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å
- –§–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç —Å —á—ë—Ç–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–æ–º–º–∏—Ç–∞:** –û—Å—Ç–∞–Ω–æ–≤–∏—Å—å –∏ –ø–æ–∫–∞–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–∑–º–µ–Ω–µ–Ω–∏—è. –î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∫–æ–º–º–∏—Ç–æ–º.

---

### –ö–æ–º–º–∏—Ç 4: API –¥–ª—è RAG-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

**–ó–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å HTTP API –¥–ª—è RAG-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —Å RAG –∏ –±–µ–∑ RAG.

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. `RAGController` ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è RAG-–∑–∞–ø—Ä–æ—Å–æ–≤
   - `POST /api/rag/query` ‚Äî RAG-–∑–∞–ø—Ä–æ—Å (—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º)
   - `POST /api/rag/standard` ‚Äî –æ–±—ã—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
   - `POST /api/rag/compare` ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–æ–≤

2. `ComparisonService` ‚Äî —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±–æ–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤ (RAG –∏ STANDARD)
   - –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–ª–∏—á–∏–π

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
server/
‚îú‚îÄ‚îÄ src/main/kotlin/com/prike/
‚îÇ   ‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ComparisonService.kt
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ model/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ComparisonResult.kt
‚îÇ   ‚îî‚îÄ‚îÄ presentation/
‚îÇ       ‚îú‚îÄ‚îÄ controller/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ RAGController.kt
‚îÇ       ‚îî‚îÄ‚îÄ dto/
‚îÇ           ‚îú‚îÄ‚îÄ RAGQueryRequestDto.kt
‚îÇ           ‚îú‚îÄ‚îÄ RAGQueryResponseDto.kt
‚îÇ           ‚îî‚îÄ‚îÄ ComparisonResponseDto.kt
```

**API Endpoints:**

1. **RAG-–∑–∞–ø—Ä–æ—Å:**
```kotlin
POST /api/rag/query
Body: {
    "question": "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?",
    "topK": 3,
    "minSimilarity": 0.5
}
Response: {
    "question": "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?",
    "answer": "–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è MCP —Å–µ—Ä–≤–µ—Ä–∞ –Ω—É–∂–Ω–æ...",
    "contextChunks": [
        {
            "chunkId": "...",
            "documentPath": "documents/01-mcp-server-creation.md",
            "content": "...",
            "similarity": 0.89
        }
    ],
    "tokensUsed": 150
}
```

2. **–û–±—ã—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å:**
```kotlin
POST /api/rag/standard
Body: {
    "question": "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?"
}
Response: {
    "question": "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?",
    "answer": "MCP —Å–µ—Ä–≤–µ—Ä –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å...",
    "tokensUsed": 120
}
```

3. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**
```kotlin
POST /api/rag/compare
Body: {
    "question": "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?",
    "topK": 3,
    "minSimilarity": 0.5
}
Response: {
    "question": "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?",
    "ragResponse": {
        "answer": "...",
        "contextChunks": [...],
        "tokensUsed": 150
    },
    "standardResponse": {
        "answer": "...",
        "tokensUsed": 120
    }
}
```

**–í–∞–∂–Ω–æ:**
- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å JSON
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—à–∏–±–∫–∏ (–±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, LLM –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
- –õ–æ–≥–∏—Ä—É–π –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–æ–º–º–∏—Ç–∞:** –û—Å—Ç–∞–Ω–æ–≤–∏—Å—å –∏ –ø–æ–∫–∞–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–∑–º–µ–Ω–µ–Ω–∏—è. –î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∫–æ–º–º–∏—Ç–æ–º.

---

### –ö–æ–º–º–∏—Ç 5: UI –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è RAG –∏ –æ–±—ã—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

**–ó–∞–¥–∞—á–∞:** –î–æ–±–∞–≤–∏—Ç—å –≤ UI –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–∞ –ø–æ–¥—Ö–æ–¥–∞: —Å RAG –∏ –±–µ–∑ RAG.

**–í–∞–∂–Ω–æ:** 
- **–ù–ï –£–î–ê–õ–Ø–¢–¨** —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π UI –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ (–∏–∑ —É—Ä–æ–∫–∞ 15)
- –û—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞ –∫–∞–∫ –µ—Å—Ç—å
- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è RAG –∏ –æ–±—ã—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. –ù–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `rag-compare.html`:
   - –ü–æ–ª–µ –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞
   - –ö–Ω–æ–ø–∫–∞ "–°—Ä–∞–≤–Ω–∏—Ç—å" (–æ–±–∞ —Ä–µ–∂–∏–º–∞)
   - –î–≤–∞ –±–ª–æ–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ —Ä—è–¥–æ–º (RAG vs STANDARD)
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ (–¥–ª—è RAG)
   - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–ª–∏—á–∏–π

2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `index.html`:
   - –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
   - –û—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Å—ã–ª–∫–∏ (–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è, –ø–æ–∏—Å–∫)

3. JavaScript –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API:
   - `rag-compare.js` ‚Äî –ª–æ–≥–∏–∫–∞ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API endpoints

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
client/
‚îú‚îÄ‚îÄ index.html  # –æ–±–Ω–æ–≤–∏—Ç—å: –¥–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ indexing.html  # –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
‚îú‚îÄ‚îÄ search.html  # –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
‚îú‚îÄ‚îÄ rag-compare.html  # –Ω–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ style.css  # –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–∏–ª–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
‚îú‚îÄ‚îÄ app.js  # –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
‚îú‚îÄ‚îÄ indexing.js  # –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
‚îú‚îÄ‚îÄ search.js  # –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
‚îî‚îÄ‚îÄ rag-compare.js  # –Ω–æ–≤—ã–π —Ñ–∞–π–ª
```

**UI —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:**
- –ü–æ–ª–µ –≤–≤–æ–¥–∞ –≤–æ–ø—Ä–æ—Å–∞
- –ö–Ω–æ–ø–∫–∞ "–°—Ä–∞–≤–Ω–∏—Ç—å"
- –î–≤–∞ –±–ª–æ–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ —Ä—è–¥–æ–º:
  - –õ–µ–≤—ã–π: RAG-–æ—Ç–≤–µ—Ç (—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º)
  - –ü—Ä–∞–≤—ã–π: –û–±—ã—á–Ω—ã–π –æ—Ç–≤–µ—Ç (–±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
- –°–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ (–¥–ª—è RAG)
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–í–∞–∂–Ω–æ:**
- –ù–µ —É–¥–∞–ª—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
- –ù–µ –º–µ–Ω—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–æ–º–º–∏—Ç–∞:** –û—Å—Ç–∞–Ω–æ–≤–∏—Å—å –∏ –ø–æ–∫–∞–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–∑–º–µ–Ω–µ–Ω–∏—è. –î–æ–∂–¥–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∫–æ–º–º–∏—Ç–æ–º.

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π

**–í–∞–∂–Ω–æ:** –í —É—Ä–æ–∫–µ 15 —Ç–µ–∫—Å—Ç —á–∞–Ω–∫–æ–≤ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î –≤ –ø–æ–ª–µ `content` —Ç–∞–±–ª–∏—Ü—ã `document_chunks`. –≠—Ç–æ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —á–∞–Ω–∫–æ–≤:**
   - –¢–µ–∫—Å—Ç —á–∞–Ω–∫–æ–≤ –±–µ—Ä—ë—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –ë–î (–ø–æ–ª–µ `content`)
   - –ù–µ –Ω—É–∂–Ω–æ –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∞–π–ª–æ–≤
   - –í—Å–µ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –µ—Å—Ç—å –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π

2. **–ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π:**
   - –ò—Å–ø–æ–ª—å–∑—É–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `KnowledgeBaseSearchService` –∏–∑ —É—Ä–æ–∫–∞ 15
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–π —ç–º–±–µ–¥–¥–∏–Ω–≥ –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ Ollama
   - –ò—â–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —á–∞–Ω–∫–∏ –ø–æ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–º—É —Å—Ö–æ–¥—Å—Ç–≤—É
   - –ü–æ–ª—É—á–∞–π —Ç–µ–∫—Å—Ç —á–∞–Ω–∫–æ–≤ –∏–∑ –ø–æ–ª—è `content` –≤ –ë–î

### –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è RAG:**
```
{systemMessage}

–ö–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π:

{contextChunks}

–í–æ–ø—Ä–æ—Å: {question}

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
- –û—Ç–≤–µ—á–∞–π —Ç–æ–ª—å–∫–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ï—Å–ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –æ—Ç–≤–µ—Ç–∞, —Å–∫–∞–∂–∏ –æ–± —ç—Ç–æ–º
- –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ï—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤–∞, —É–∫–∞–∂–∏ –Ω–∞ —ç—Ç–æ

–û—Ç–≤–µ—Ç:
```

**–§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
```
[–ß–∞–Ω–∫ 1] (–¥–æ–∫—É–º–µ–Ω—Ç: documents/01-mcp-server-creation.md, —Å—Ö–æ–¥—Å—Ç–≤–æ: 0.89)
{content}

[–ß–∞–Ω–∫ 2] (–¥–æ–∫—É–º–µ–Ω—Ç: documents/01-mcp-server-creation.md, —Å—Ö–æ–¥—Å—Ç–≤–æ: 0.76)
{content}

[–ß–∞–Ω–∫ 3] (–¥–æ–∫—É–º–µ–Ω—Ç: documents/02-embeddings-and-vector-search.md, —Å—Ö–æ–¥—Å—Ç–≤–æ: 0.65)
{content}
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ OpenRouter

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ –ø–æ–¥—Ö–æ–¥, —á—Ç–æ –≤ —É—Ä–æ–∫–µ 14:**
- –ö–ª–∏–µ–Ω—Ç `OpenAIClient` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å OpenRouter API
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `config/server.yaml` –∏ `.env`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ chat completions

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

1. **–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞:**
   - –ü–æ–∫–∞–∑—ã–≤–∞–π –ø–æ–Ω—è—Ç–Ω—É—é –æ—à–∏–±–∫—É
   - –ü—Ä–µ–¥–ª–∞–≥–∞–π –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç—å –∫ –ë–î

2. **LLM –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:**
   - –ü–æ–∫–∞–∑—ã–≤–∞–π –ø–æ–Ω—è—Ç–Ω—É—é –æ—à–∏–±–∫—É
   - –ü—Ä–µ–¥–ª–∞–≥–∞–π –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `OPENAI_API_KEY` –≤ `.env`

3. **–ß–∞–Ω–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ë–î:**
   - –õ–æ–≥–∏—Ä—É–π –æ—à–∏–±–∫—É
   - –ü—Ä–æ–ø—É—Å–∫–∞–π —á–∞–Ω–∫
   - –ü—Ä–æ–¥–æ–ª–∂–∞–π —Ä–∞–±–æ—Ç—É —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ —á–∞–Ω–∫–∞–º–∏

4. **–ù–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤:**
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ü—Ä–µ–¥–ª–∞–≥–∞–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–í–æ–ø—Ä–æ—Å—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ RAG –¥–æ–ª–∂–µ–Ω –ø–æ–º–æ—á—å:**
   - "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä?"
   - "–ö–∞–∫ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —á–µ—Ä–µ–∑ Ollama?"
   - "–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —á–∞–Ω–∫–æ–≤?"
   - "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ?"

2. **–í–æ–ø—Ä–æ—Å—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ RAG –º–æ–∂–µ—Ç –Ω–µ –ø–æ–º–æ—á—å:**
   - "–ö–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –±–æ—Ä—â?" (–Ω–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö)
   - "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–≤–∞–Ω—Ç–æ–≤–∞—è —Ñ–∏–∑–∏–∫–∞?" (–Ω–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö)
   - –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ LLM –º–æ–∂–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### –í—ã–≤–æ–¥—ã —É—Ä–æ–∫–∞:

1. **–ì–¥–µ RAG –ø–æ–º–æ–≥–∞–µ—Ç:**
   - –í–æ–ø—Ä–æ—Å—ã –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
   - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã
   - –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

2. **–ì–¥–µ RAG –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:**
   - –í–æ–ø—Ä–æ—Å—ã –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ LLM –º–æ–∂–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å —Å–∞–º
   - –£—Å—Ç–∞—Ä–µ–≤—à–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö

3. **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RAG:**
   - –ï—Å—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
   - –ù—É–∂–Ω—ã —Ç–æ—á–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –í–∞–∂–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

---

## üéì –¶–µ–ª–∏ —É—Ä–æ–∫–∞

- –ü–æ–¥–∫–ª—é—á–∏—Ç—å RAG –∫ LLM —á–µ—Ä–µ–∑ OpenRouter
- –ü–æ–Ω—è—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å RAG –∏ –±–µ–∑ RAG
- –°—Ä–∞–≤–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç—ã —Å RAG –∏ –±–µ–∑ RAG
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –≤ –∞–≥–µ–Ω—Ç–∞

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [RAG: Retrieval-Augmented Generation (Paper)](https://arxiv.org/abs/2005.11401)
- [OpenRouter API Documentation](https://openrouter.ai/docs)
- [LangChain RAG Tutorial](https://python.langchain.com/docs/use_cases/question_answering/)
