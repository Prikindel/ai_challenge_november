# Уникальная информация о проекте "AI Challenge November 2024"

## Общая информация

Проект "AI Challenge November 2024" был запущен 15 ноября 2024 года командой разработчиков под руководством технического директора **Александра Петрова**. Проект использует уникальный идентификатор проекта: `PRJ-AIC-2024-NOV-001`.

## Архитектура системы

### Основные компоненты

Система состоит из трёх основных модулей:

1. **Модуль индексации** (кодовое имя: "Indexer-X7")
   - Версия: 2.3.1-beta
   - Порт по умолчанию: 8080
   - Максимальный размер чанка: 512 токенов
   - Использует алгоритм нормализации векторов "VectorNorm-v3"

2. **Модуль поиска** (кодовое имя: "Searcher-Y9")
   - Версия: 1.8.4
   - Алгоритм поиска: "CosineSimilarity-Pro"
   - Минимальный порог сходства: 0.65
   - Кэширование результатов: 5 минут

3. **Модуль RAG** (кодовое имя: "RAG-Z12")
   - Версия: 3.0.0-alpha
   - Максимальное количество чанков: 5
   - Стратегия объединения: "WeightedAverage"

### Специфические настройки

**База данных:**
- Тип: SQLite
- Имя файла: `knowledge_base.db`
- Версия схемы: 4
- Кодировка: UTF-8
- Максимальный размер: 500 МБ

**Эмбеддинги:**
- Модель: `nomic-embed-text` (локальная через Ollama)
- Размерность вектора: 768
- Нормализация: L2-норма
- Формат хранения: BLOB (JSON)

## Уникальные идентификаторы

### Команда разработки

- **Технический директор:** Александр Петров (ID: TD-2024-001)
- **Ведущий разработчик:** Мария Сидорова (ID: LD-2024-045)
- **Архитектор:** Дмитрий Козлов (ID: ARCH-2024-012)

### Внутренние стандарты

**Стандарт кодирования:**
- Язык: Kotlin 1.9.0+
- Стиль: KtLint с правилами "prike-style-v2"
- Максимальная длина строки: 120 символов
- Обязательное использование корутин для асинхронных операций

**Стандарт именования:**
- Классы: PascalCase с префиксом модуля (например, `RAGService`, `IndexingController`)
- Функции: camelCase с глаголом действия (например, `generateEmbedding`, `searchChunks`)
- Константы: UPPER_SNAKE_CASE (например, `MAX_CHUNK_SIZE`, `DEFAULT_TOP_K`)

## Специфические алгоритмы

### Алгоритм "SmartChunking-v2"

Этот алгоритм используется для разбиения документов на чанки:

1. **Предобработка:**
   - Удаление лишних пробелов
   - Нормализация переносов строк
   - Обработка Markdown-разметки

2. **Разбиение:**
   - Минимальный размер чанка: 100 токенов
   - Максимальный размер чанка: 512 токенов
   - Перекрытие между чанками: 50 токенов
   - Приоритет разбиения по абзацам, затем по предложениям

3. **Постобработка:**
   - Добавление метаданных (номер чанка, индекс начала/конца)
   - Валидация размера
   - Генерация уникального ID (формат: `CHUNK-{docId}-{index}-{timestamp}`)

### Алгоритм "ContextMerger-Pro"

Используется для объединения нескольких чанков в контекст:

1. Сортировка чанков по сходству (убывание)
2. Взвешенное объединение (вес = сходство^2)
3. Ограничение общей длины контекста (максимум 2000 токенов)
4. Добавление разделителей между чанками

## Внутренние API endpoints

### Специфические endpoints проекта

1. **POST /api/rag/query**
   - Версия API: v1
   - Максимальный размер запроса: 10 КБ
   - Таймаут: 60 секунд
   - Лимит запросов: 100/минуту

2. **POST /api/rag/compare**
   - Версия API: v1
   - Максимальный размер запроса: 10 КБ
   - Таймаут: 120 секунд
   - Лимит запросов: 50/минуту

3. **GET /api/health**
   - Версия API: v1
   - Проверяет статус Ollama, базы данных и OpenRouter
   - Формат ответа: JSON с полями `status`, `service`, `ollama`

## Конфигурационные параметры

### Уникальные настройки проекта

```yaml
project:
  name: "AI Challenge November 2024"
  version: "1.0.0"
  environment: "development"
  debug: true
  
indexing:
  chunkSize: 512
  overlapSize: 50
  algorithm: "SmartChunking-v2"
  
search:
  defaultLimit: 10
  minSimilarity: 0.65
  algorithm: "CosineSimilarity-Pro"
  cacheEnabled: true
  cacheTTL: 300
  
rag:
  maxChunks: 5
  contextMerger: "ContextMerger-Pro"
  promptTemplate: "rag-template-v3"
```

## Специфические метрики

Система собирает следующие метрики:

- **Время индексации документа:** среднее, медиана, перцентили (p50, p95, p99)
- **Время поиска:** среднее, медиана, перцентили
- **Точность поиска:** precision@k для k={1,3,5,10}
- **Использование токенов:** среднее количество токенов на запрос
- **Hit rate:** процент запросов, для которых найдены релевантные чанки

## Уникальные особенности реализации

### Обработка ошибок

Система использует кастомную иерархию исключений:

- `KnowledgeBaseException` - базовое исключение для работы с БД
- `EmbeddingGenerationException` - ошибки генерации эмбеддингов
- `RAGQueryException` - ошибки RAG-запросов
- `LLMServiceException` - ошибки работы с LLM

### Логирование

Используется структурированное логирование с форматом:

```
[YYYY-MM-DD HH:mm:ss.SSS] [LEVEL] [MODULE] [THREAD] - MESSAGE {metadata}
```

Пример:
```
[2024-11-16 14:23:45.123] [INFO] [RAGService] [eventLoopGroupProxy-4-7] - RAG query completed {question="Что такое эмбединги", chunks=3, tokens=150}
```

## Контакты и поддержка

**Email поддержки:** support@ai-challenge-nov-2024.local
**Внутренний чат:** #ai-challenge-nov-2024 (Slack)
**Документация:** https://internal-docs.ai-challenge-nov-2024.local

---

*Документ создан: 16 ноября 2024*
*Последнее обновление: 16 ноября 2024*
*Версия документа: 1.0*

