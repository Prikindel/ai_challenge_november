# Руководство по параметрам LLM

Подробное описание параметров локальной LLM и их влияния на качество ответов.

## Temperature (Температура)

**Диапазон:** 0.0 - 2.0  
**По умолчанию:** 0.7

### Описание
Контролирует случайность/креативность ответов. Чем выше значение, тем более разнообразные и непредсказуемые ответы.

### Влияние на ответы

**0.0 - 0.3: Детерминированные ответы**
- ✅ Максимальная точность и воспроизводимость
- ✅ Хорошо для: фактов, точных данных, программирования, QA
- ❌ Может быть слишком шаблонным
- ❌ Плохо для творческих задач

**0.4 - 0.6: Сбалансированные ответы**
- ✅ Хороший баланс точности и разнообразия
- ✅ Хорошо для: технических вопросов, объяснений

**0.7 - 0.9: Стандартные ответы (рекомендуется)**
- ✅ Оптимальный баланс для большинства задач
- ✅ Хорошо для: общего чата, общих вопросов
- ✅ По умолчанию в большинстве моделей

**1.0 - 1.5: Креативные ответы**
- ✅ Более разнообразные и интересные ответы
- ✅ Хорошо для: творческих задач, генерации идей, написания текста
- ⚠️ Может быть менее точным

**1.5 - 2.0: Очень креативные ответы**
- ✅ Максимальная креативность
- ⚠️ Может быть слишком случайным и неточным
- ❌ Не рекомендуется для большинства задач

### Рекомендации

| Задача | Temperature | Примечание |
|--------|-------------|------------|
| Точные факты | 0.1 - 0.3 | Максимальная точность |
| Программирование | 0.3 - 0.5 | Баланс точности и полезности |
| Общие вопросы | 0.7 - 0.9 | Стандартное значение |
| Творческие задачи | 1.0 - 1.5 | Больше разнообразия |
| Генерация текста | 0.8 - 1.2 | Баланс креативности и связности |

---

## Max Tokens (Максимальное количество токенов)

**Диапазон:** 1 - 8192+ (зависит от модели)  
**По умолчанию:** 2048

### Описание
Максимальная длина ответа в токенах. Ограничивает, сколько токенов модель может сгенерировать.

### Влияние на ответы

**512 - 1024: Короткие ответы**
- ✅ Быстрые ответы
- ✅ Хорошо для: чата, кратких ответов, подтверждений
- ❌ Может обрезать длинные ответы

**2048 - 4096: Средние ответы (рекомендуется)**
- ✅ Подходит для большинства задач
- ✅ Баланс между длиной и скоростью
- ✅ По умолчанию в большинстве моделей

**8192+: Длинные ответы**
- ✅ Полные, развёрнутые ответы
- ✅ Хорошо для: генерации текста, длинных объяснений
- ⚠️ Требует больше времени и памяти

### Рекомендации

| Задача | Max Tokens | Примечание |
|--------|------------|------------|
| Краткие ответы | 512 - 1024 | Быстро и лаконично |
| Общие вопросы | 2048 - 4096 | Стандартное значение |
| Длинные объяснения | 4096 - 8192 | Полные ответы |
| Генерация текста | 8192+ | Длинные тексты |

---

## Context Window (Контекстное окно)

**Диапазон:** 2048 - 16384+ (зависит от модели)  
**По умолчанию:** 4096

### Описание
Размер контекста, который модель может обработать. Включает промпт, историю диалога и контекст.

### Влияние на ответы

**2048: Базовый контекст**
- ✅ Минимальное использование памяти
- ✅ Хорошо для: простых задач, коротких диалогов
- ❌ Может потерять контекст в длинных диалогах

**4096: Стандартный контекст (рекомендуется)**
- ✅ Подходит для большинства задач
- ✅ Хорошо для: чата, общих вопросов, RAG с небольшим контекстом
- ✅ По умолчанию в большинстве моделей

**8192+: Большой контекст**
- ✅ Может обработать длинную историю диалога
- ✅ Хорошо для: RAG с большим контекстом, длинных документов
- ⚠️ Требует больше RAM
- ⚠️ Может быть медленнее

### Рекомендации

| Задача | Context Window | Примечание |
|--------|----------------|------------|
| Простые задачи | 2048 | Минимум памяти |
| Общие задачи | 4096 | Стандартное значение |
| RAG с контекстом | 8192+ | Большой контекст |
| Длинные диалоги | 8192+ | Сохранение истории |

---

## Top-P (Nucleus Sampling)

**Диапазон:** 0.0 - 1.0  
**По умолчанию:** 0.9

### Описание
Контролирует разнообразие токенов, рассматривая только токены с суммарной вероятностью до P.

### Влияние на ответы

**0.0 - 0.7: Более детерминированные**
- ✅ Более предсказуемые ответы
- ✅ Хорошо для: точных ответов, фактов
- ❌ Может быть менее разнообразным

**0.8 - 0.95: Сбалансированные (рекомендуется)**
- ✅ Хороший баланс разнообразия и качества
- ✅ По умолчанию в большинстве моделей

**0.95 - 1.0: Более разнообразные**
- ✅ Больше разнообразия в ответах
- ⚠️ Может быть менее точным

### Рекомендации

| Задача | Top-P | Примечание |
|--------|-------|------------|
| Точные ответы | 0.7 - 0.8 | Меньше разнообразия |
| Общие задачи | 0.9 | Стандартное значение |
| Креативные задачи | 0.95 - 1.0 | Больше разнообразия |

---

## Top-K

**Диапазон:** 1 - 100+  
**По умолчанию:** 40

### Описание
Ограничивает выборку только топ-K наиболее вероятных токенов.

### Влияние на ответы

**1 - 20: Очень детерминированные**
- ✅ Максимально предсказуемые ответы
- ❌ Может быть слишком шаблонным

**40 - 60: Сбалансированные (рекомендуется)**
- ✅ Хороший баланс
- ✅ По умолчанию в большинстве моделей

**80 - 100+: Более разнообразные**
- ✅ Больше разнообразия
- ⚠️ Может быть менее точным

### Рекомендации

| Задача | Top-K | Примечание |
|--------|-------|------------|
| Точные ответы | 20 - 40 | Меньше разнообразия |
| Общие задачи | 40 | Стандартное значение |
| Креативные задачи | 60 - 100 | Больше разнообразия |

---

## Repeat Penalty (Штраф за повторения)

**Диапазон:** 0.0 - 2.0  
**По умолчанию:** 1.1

### Описание
Штраф за повторение токенов. Чем выше значение, тем сильнее модель избегает повторений.

### Влияние на ответы

**0.0 - 1.0: Разрешает повторения**
- ⚠️ Модель может повторяться
- ❌ Не рекомендуется

**1.1 - 1.3: Стандартный штраф (рекомендуется)**
- ✅ Хороший баланс
- ✅ По умолчанию в большинстве моделей

**1.4 - 2.0: Сильный штраф**
- ✅ Минимум повторений
- ⚠️ Может быть слишком разнообразным

### Рекомендации

| Проблема | Repeat Penalty | Примечание |
|----------|----------------|------------|
| Модель повторяется | 1.2 - 1.5 | Увеличить штраф |
| Стандартное использование | 1.1 | По умолчанию |
| Слишком разнообразные ответы | 1.0 - 1.1 | Уменьшить штраф |

---

## Seed (Сид)

**Диапазон:** Любое целое число или null  
**По умолчанию:** null

### Описание
Сид для генерации случайных чисел. Позволяет воспроизводить одинаковые ответы.

### Влияние на ответы

**null: Случайный сид**
- ✅ Разнообразные ответы
- ✅ По умолчанию

**Число: Фиксированный сид**
- ✅ Воспроизводимые ответы
- ✅ Хорошо для: тестирования, отладки
- ❌ Меньше разнообразия

### Рекомендации

| Задача | Seed | Примечание |
|--------|-----|------------|
| Продакшен | null | Разнообразие |
| Тестирование | Фиксированное число | Воспроизводимость |
| Отладка | Фиксированное число | Постоянные результаты |

---

## Комбинации параметров для разных задач

### Точные ответы (QA, факты)
```yaml
temperature: 0.3
maxTokens: 1024
topP: 0.8
topK: 20
repeatPenalty: 1.1
contextWindow: 4096
```

### Программирование
```yaml
temperature: 0.5
maxTokens: 2048
topP: 0.9
topK: 40
repeatPenalty: 1.2
contextWindow: 4096
```

### Общие вопросы (чат)
```yaml
temperature: 0.7
maxTokens: 2048
topP: 0.9
topK: 40
repeatPenalty: 1.1
contextWindow: 4096
```

### Творческие задачи
```yaml
temperature: 1.2
maxTokens: 4096
topP: 0.95
topK: 60
repeatPenalty: 1.1
contextWindow: 8192
```

### RAG с контекстом
```yaml
temperature: 0.3
maxTokens: 2048
topP: 0.8
topK: 40
repeatPenalty: 1.1
contextWindow: 8192
```

---

## Советы по оптимизации

1. **Начните с значений по умолчанию** — они обычно хорошо работают
2. **Тестируйте на реальных задачах** — не полагайтесь только на синтетические тесты
3. **Изменяйте по одному параметру** — так легче понять влияние каждого
4. **Фиксируйте результаты** — записывайте, что работает лучше
5. **Учитывайте задачу** — разные задачи требуют разных параметров
6. **Балансируйте скорость и качество** — больше параметров ≠ лучше

