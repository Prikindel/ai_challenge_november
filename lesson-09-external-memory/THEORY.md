# üìö –¢–µ–æ—Ä–∏—è: –í–Ω–µ—à–Ω—è—è –ø–∞–º—è—Ç—å –¥–ª—è LLM

## –ß—Ç–æ —Ç–∞–∫–æ–µ –≤–Ω–µ—à–Ω—è—è –ø–∞–º—è—Ç—å –¥–ª—è LLM?

**–í–Ω–µ—à–Ω—è—è –ø–∞–º—è—Ç—å** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π —Å —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª—å—é –≤–Ω–µ —Å–∞–º–æ–π –º–æ–¥–µ–ª–∏. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –º–æ–¥–µ–ª–∏ (—Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø—Ä–æ–º–ø—Ç–µ), –≤–Ω–µ—à–Ω—è—è –ø–∞–º—è—Ç—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏ –∏ –∑–∞–ø—É—Å–∫–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:

1. **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–∫ (–ë–î –∏–ª–∏ —Ñ–∞–π–ª) –∏ –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. **–î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å** ‚Äî –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –±—É–¥—É—â–∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö
3. **–ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞** ‚Äî –≤—Å—è –∏—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å–≤—è–∑–Ω–æ—Å—Ç–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

---

## –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤ –¥–∏–∞–ª–æ–≥–∞—Ö?

### –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –≤–Ω–µ—à–Ω–µ–π –ø–∞–º—è—Ç–∏:

#### 1. **–ü–æ—Ç–µ—Ä—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ò–≤–∞–Ω"
–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç: "–ü—Ä–∏—è—Ç–Ω–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è, –ò–≤–∞–Ω!"

[–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è]

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ö–∞–∫ –º–µ–Ω—è –∑–æ–≤—É—Ç?"
–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç: "–Ø –Ω–µ –∑–Ω–∞—é, –∫–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç..." ‚ùå
```

#### 2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –ø—Ä–æ–º–ø—Ç–µ**
- LLM –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø—Ä–æ–º–ø—Ç–µ (–æ–±—ã—á–Ω–æ 2K-128K)
- –°—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è "–∑–∞–±—ã–≤–∞—é—Ç—Å—è" –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–µ—Å—Å–∏–π

#### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π**
- –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ù–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –¥–∏–∞–ª–æ–≥–∞–º
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä —Å —É—á—ë—Ç–æ–º –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç–µ–º

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å –≤–Ω–µ—à–Ω–µ–π –ø–∞–º—è—Ç—å—é:

#### ‚úÖ **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å –¥–∏–∞–ª–æ–≥–∞**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ò–≤–∞–Ω"
‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î

[–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è]
‚Üí –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ö–∞–∫ –º–µ–Ω—è –∑–æ–≤—É—Ç?"
–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç: "–í–∞—Å –∑–æ–≤—É—Ç –ò–≤–∞–Ω!" ‚úÖ
```

#### ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π**
- –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ–º–Ω–∏—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏
- –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö

#### ‚úÖ **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —É–ª—É—á—à–µ–Ω–∏–µ**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–∏–∞–ª–æ–≥–∞–º
- –ê–Ω–∞–ª–∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–µ–º
- –ü–æ–∏—Å–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ –∏—Å—Ç–æ—Ä–∏–∏

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ SQLite vs JSON –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è

### SQLite (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

#### ‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫ (O(log n))
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å WHERE/JOIN
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ SQL

2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–º–∏–ª–ª–∏–æ–Ω—ã –∑–∞–ø–∏—Å–µ–π)
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (ACID)
   - –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø (WAL —Ä–µ–∂–∏–º)

3. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**
   - –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–∞–≥—Ä–µ–≥–∞—Ü–∏–∏, —Ñ–∏–ª—å—Ç—Ä—ã)
   - –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –ë–î
   - –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–¥–∏–Ω —Ñ–∞–π–ª)

4. **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**
   - ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å)
   - –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (foreign keys, constraints)
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤

#### ‚ùå **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**

1. **–°–ª–æ–∂–Ω–æ—Å—Ç—å**
   - –¢—Ä–µ–±—É–µ—Ç –∑–Ω–∞–Ω–∏—è SQL
   - –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã
   - –ë–æ–ª—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (JDBC –¥—Ä–∞–π–≤–µ—Ä)

2. **–§–æ—Ä–º–∞—Ç**
   - –ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª (–Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ)
   - –ù—É–∂–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (DB Browser for SQLite)

### JSON (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏/–ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–≤)

#### ‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞**
   - –ß–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç (–º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ)
   - –õ–µ–≥–∫–æ –¥–µ–±–∞–∂–∏—Ç—å –∏ –∏–Ω—Å–ø–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
   - –ù–µ —Ç—Ä–µ–±—É–µ—Ç SQL –∑–Ω–∞–Ω–∏–π

2. **–ì–∏–±–∫–æ—Å—Ç—å**
   - –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
   - –ù–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–π (–ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω—è–µ—Ç–µ –º–æ–¥–µ–ª—å)
   - –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å (–ª–µ–≥–∫–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª)

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
   - –ù–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ Kotlin (kotlinx.serialization)
   - JSON —Å—Ç–∞–Ω–¥–∞—Ä—Ç (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
   - –õ–µ–≥–∫–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å/–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å

#### ‚ùå **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - –ü–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏
   - O(n) –ø–æ–∏—Å–∫ (–ª–∏–Ω–µ–π–Ω—ã–π)
   - –ú–µ–¥–ª–µ–Ω–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (>10MB)

2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**
   - –ü–ª–æ—Ö–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –±–æ–ª—å—à–∏–µ –æ–±—ä—ë–º—ã
   - –í–µ—Å—å —Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ
   - –ù–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤

3. **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**
   - –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–º–æ–∂–µ—Ç –±—ã—Ç—å —á–∞—Å—Ç–∏—á–Ω–∞—è –∑–∞–ø–∏—Å—å –ø—Ä–∏ —Å–±–æ–µ)
   - –ù—É–∂–Ω–∞ —Ä—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
   - –ú–µ–Ω—å—à–µ –∑–∞—â–∏—Ç—ã –æ—Ç –æ—à–∏–±–æ–∫

### –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞:

| –ö—Ä–∏—Ç–µ—Ä–∏–π | SQLite | JSON |
|----------|--------|------|
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞** | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| **–ì–∏–±–∫–æ—Å—Ç—å —Å—Ö–µ–º—ã** | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É:

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SQLite, –µ—Å–ª–∏:**
- –ù—É–∂–Ω–∞ –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ë–æ–ª—å—à–∏–µ –æ–±—ä—ë–º—ã –¥–∞–Ω–Ω—ã—Ö (>1000 –∑–∞–ø–∏—Å–µ–π)
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫/—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –ü—Ä–æ–¥–∞–∫—à–µ–Ω –æ–∫—Ä—É–∂–µ–Ω–∏–µ

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ JSON, –µ—Å–ª–∏:**
- –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞/–ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–∞–ª–µ–Ω—å–∫–∏–µ –æ–±—ä—ë–º—ã –¥–∞–Ω–Ω—ã—Ö (<1000 –∑–∞–ø–∏—Å–µ–π)
- –ù—É–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–µ–≥–∫–æ—Å—Ç—å –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–∞–±–æ—Ç—ã —Å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é

### 1. **–ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è (Full History)**

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤—Å—è –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤ –±–µ–∑ —Å–∂–∞—Ç–∏—è.

```kotlin
// –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å
history = [
    Message(role=USER, content="–ü—Ä–∏–≤–µ—Ç"),
    Message(role=ASSISTANT, content="–ü—Ä–∏–≤–µ—Ç!"),
    Message(role=USER, content="–ö–∞–∫ –¥–µ–ª–∞?"),
    Message(role=ASSISTANT, content="–•–æ—Ä–æ—à–æ!"),
    // ... –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
]
```

**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –¢–æ—á–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤

**–ú–∏–Ω—É—Å—ã:**
- –ë—ã—Å—Ç—Ä—ã–π —Ä–æ—Å—Ç —Ä–∞–∑–º–µ—Ä–∞
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤
- –ú–µ–¥–ª–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ö–æ—Ä–æ—Ç–∫–∏–µ –¥–∏–∞–ª–æ–≥–∏ (<50 —Å–æ–æ–±—â–µ–Ω–∏–π)
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è

### 2. **–°–∂–∞—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ (History Compression)**

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–∂–∏–º–∞—é—Ç—Å—è –≤ summary, –Ω–æ–≤—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –ø–æ–ª–Ω—ã–º–∏.

```kotlin
// –°—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–∂–∞—Ç—ã
history = [
    Summary(content="–û–±—Å—É–¥–∏–ª–∏ –ø–æ–≥–æ–¥—É –∏ –ø–ª–∞–Ω—ã –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ"),
    Message(role=USER, content="–ß—Ç–æ –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏?"),  // –ù–µ–¥–∞–≤–Ω–µ–µ
    Message(role=ASSISTANT, content="–ú—ã –æ–±—Å—É–∂–¥–∞–ª–∏..."),
]
```

**–ü–ª—é—Å—ã:**
- –≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- –ü–æ—Ç–µ—Ä—è –¥–µ—Ç–∞–ª–µ–π –≤ summary
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ù—É–∂–Ω–∞ –º–æ–¥–µ–ª—å –¥–ª—è —Å–∂–∞—Ç–∏—è

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –î–ª–∏–Ω–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ (>100 —Å–æ–æ–±—â–µ–Ω–∏–π)
- –ù—É–∂–Ω–∞ —ç–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- –í–∞–∂–µ–Ω –æ–±—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–Ω–µ –¥–µ—Ç–∞–ª–∏)

### 3. **–°–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ (Sliding Window)**

**–û–ø–∏—Å–∞–Ω–∏–µ:** –•—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π.

```kotlin
// –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–æ–æ–±—â–µ–Ω–∏–π
history = lastMessages.take(20)
// –°—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —É–¥–∞–ª—è—é—Ç—Å—è
```

**–ü–ª—é—Å—ã:**
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä
- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø
- –ü—Ä–æ—Å—Ç–æ—Ç–∞

**–ú–∏–Ω—É—Å—ã:**
- –ü–æ—Ç–µ—Ä—è —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ù—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ —Å–≤–µ–∂–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±—é–¥–∂–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤
- –ü—Ä–æ—Å—Ç—ã–µ –¥–∏–∞–ª–æ–≥–∏

### 4. **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã (Key Moments)**

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–ª–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º).

```kotlin
// –¢–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
history = messages.filter { it.isImportant }
// + –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π
```

**–ü–ª—é—Å—ã:**
- –§–æ–∫—É—Å –Ω–∞ –≤–∞–∂–Ω–æ–º
- –≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞
- –†–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–∞–∂–Ω–æ—Å—Ç–∏
- –ú–æ–∂–Ω–æ –ø–æ—Ç–µ—Ä—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ï—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏
- –ù—É–∂–µ–Ω —Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

### 5. **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å (Hierarchical Memory)**

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è + –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å).

```kotlin
// –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å (–ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π)
shortTerm = lastMessages.take(10)

// –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å (summary –∏–ª–∏ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è)
longTerm = summaries + importantEvents

// –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–º–ø—Ç–∞
context = longTerm + shortTerm
```

**–ü–ª—é—Å—ã:**
- –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –¥–µ—Ç–∞–ª—è–º–∏ –∏ –º–∞—Å—à—Ç–∞–±–æ–º
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- –ì–∏–±–∫–æ—Å—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ù—É–∂–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—ã–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –°–ª–æ–∂–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ù—É–∂–µ–Ω –±–∞–ª–∞–Ω—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. **–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤**

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
–ò—Å—Ç–æ—Ä–∏—è: 1000 —Å–æ–æ–±—â–µ–Ω–∏–π √ó 50 —Ç–æ–∫–µ–Ω–æ–≤ = 50,000 —Ç–æ–∫–µ–Ω–æ–≤
–õ–∏–º–∏—Ç LLM: 4,096 —Ç–æ–∫–µ–Ω–æ–≤
‚Üí –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞! ‚ùå
```

**–†–µ—à–µ–Ω–∏—è:**

#### a) –°–∂–∞—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
```kotlin
// –°—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Üí summary
val summary = compressOldMessages(messages.take(100))
val recent = messages.drop(100)

val context = listOf(summary) + recent  // –í–ª–µ–∑–∞–µ—Ç –≤ –ª–∏–º–∏—Ç
```

#### b) –°–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ
```kotlin
// –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π
val context = messages.takeLast(maxTokens / avgTokensPerMessage)
```

#### c) –£–º–Ω—ã–π –≤—ã–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```kotlin
// –í—ã–±–∏—Ä–∞–µ–º —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —Ç–µ–º–µ
val context = selectRelevantMessages(
    query = currentMessage,
    history = allMessages,
    maxTokens = limit
)
```

### 2. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏**

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
–ü–æ—Ç–æ–∫ 1: –ß–∏—Ç–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é ‚Üí –î–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç
–ü–æ—Ç–æ–∫ 2: –ß–∏—Ç–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é ‚Üí –î–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç
‚Üí –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö! ‚ùå
```

**–†–µ—à–µ–Ω–∏–µ:**

#### a) –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (SQLite)
```kotlin
// –ê—Ç–æ–º–∞—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
withConnection { connection ->
    connection.autoCommit = false
    // –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    saveEntry(entry1)
    saveEntry(entry2)
    connection.commit()  // –ò–ª–∏ rollback –ø—Ä–∏ –æ—à–∏–±–∫–µ
}
```

#### b) –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (JSON)
```kotlin
// –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏
synchronized(lock) {
    val storage = loadFromFile()
    storage.entries += newEntry
    saveToFile(storage)
}
```

### 3. **–ú–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –ë–î**

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
–í–µ—Ä—Å–∏—è 1: memory_entries (id, role, content, timestamp)
–í–µ—Ä—Å–∏—è 2: memory_entries (id, role, content, timestamp, metadata)
‚Üí –°—Ç–∞—Ä–∞—è –ë–î –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–∞! ‚ùå
```

**–†–µ—à–µ–Ω–∏–µ:**

#### a) –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã
```kotlin
// –î–æ–±–∞–≤–ª—è–µ–º –≤–µ—Ä—Å–∏—é –≤ –ë–î
CREATE TABLE schema_version (version INTEGER)

// –ú–∏–≥—Ä–∞—Ü–∏–∏
fun migrate(from: Int, to: Int) {
    when {
        from < 2 -> addMetadataColumn()
        from < 3 -> addIndexes()
    }
}
```

#### b) –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
```kotlin
// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é
val version = getSchemaVersion()
when (version) {
    1 -> loadV1Format()
    2 -> loadV2Format()
}
```

### 4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö**

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
10,000 –∑–∞–ø–∏—Å–µ–π √ó 1KB = 10MB
–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ–≥–æ —Ñ–∞–π–ª–∞: 2 —Å–µ–∫—É–Ω–¥—ã ‚ùå
```

**–†–µ—à–µ–Ω–∏–µ:**

#### a) –ü–∞–≥–∏–Ω–∞—Ü–∏—è
```kotlin
// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ —á–∞—Å—Ç—è–º
fun loadHistory(page: Int, pageSize: Int): List<MemoryEntry> {
    return repository.findByRange(
        offset = page * pageSize,
        limit = pageSize
    )
}
```

#### b) –ò–Ω–¥–µ–∫—Å—ã (SQLite)
```kotlin
// –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE INDEX idx_timestamp ON memory_entries(timestamp)
CREATE INDEX idx_role ON memory_entries(role)
```

#### c) –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
```kotlin
// –ö—ç—à –≤ –ø–∞–º—è—Ç–∏
class MemoryService {
    private var cachedHistory: List<MemoryEntry> = emptyList()
    
    fun getHistory() = cachedHistory  // –ò–∑ –∫—ç—à–∞, –Ω–µ –∏–∑ –ë–î
}
```

### 5. **–ü–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
JSON —Ñ–∞–π–ª –ø–æ–≤—Ä–µ–∂–¥—ë–Ω: {"entries": [{"id": "..."  // –ù–µ–ø–æ–ª–Ω—ã–π
‚Üí –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞! ‚ùå
```

**–†–µ—à–µ–Ω–∏–µ:**

#### a) –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
```kotlin
fun loadFromFile(): Result<MemoryStorage> {
    return try {
        val content = file.readText()
        val storage = json.decodeFromString<MemoryStorage>(content)
        validateStorage(storage)  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
        Result.success(storage)
    } catch (e: Exception) {
        logger.warn("–ü–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π —Ñ–∞–π–ª, —Å–æ–∑–¥–∞—é –Ω–æ–≤—ã–π: ${e.message}")
        Result.success(MemoryStorage())  // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π
    }
}
```

#### b) –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
```kotlin
// –ü–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–µ–ª–∞–µ–º backup
fun saveToFile(storage: MemoryStorage) {
    if (file.exists()) {
        val backup = File(file.absolutePath + ".backup")
        file.copyTo(backup, overwrite = true)
    }
    file.writeText(json.encodeToString(storage))
}
```

#### c) –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```kotlin
// –ü–æ–ø—ã—Ç–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
if (fileCorrupted) {
    val backup = File(file.absolutePath + ".backup")
    if (backup.exists()) {
        backup.copyTo(file, overwrite = true)
        return loadFromFile()
    }
}
```

---

## Best Practices

### 1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**

‚úÖ **–•–æ—Ä–æ—à–æ:**
```kotlin
data class MemoryEntry(
    val id: String,              // UUID –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
    val role: MessageRole,       // Enum –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
    val content: String,         // –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
    val timestamp: Long,         // Instant –∫–∞–∫ Long –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    val metadata: MemoryMetadata? // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
)
```

‚ùå **–ü–ª–æ—Ö–æ:**
```kotlin
data class MemoryEntry(
    val id: Int,           // –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —Å–ª–∏—è–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
    val role: String,      // –ù–µ—Ç —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
    val content: String,   // OK
    val timestamp: Instant // –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π
)
```

### 2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

‚úÖ **–•–æ—Ä–æ—à–æ:**
```kotlin
suspend fun save(entry: MemoryEntry): Result<Unit> {
    return try {
        repository.save(entry)
        Result.success(Unit)
    } catch (e: Exception) {
        logger.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${e.message}", e)
        Result.failure(MemoryException("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å", e))
    }
}
```

‚ùå **–ü–ª–æ—Ö–æ:**
```kotlin
suspend fun save(entry: MemoryEntry) {
    repository.save(entry)  // –ú–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏
}
```

### 3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

‚úÖ **–•–æ—Ä–æ—à–æ:**
```kotlin
// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏
private var cachedHistory: List<MemoryEntry> = emptyList()

fun getHistory() = cachedHistory  // –ë—ã—Å—Ç—Ä–æ

suspend fun loadHistory() {
    cachedHistory = repository.loadAll()  // –ó–∞–≥—Ä—É–∂–∞–µ–º 1 —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
}
```

‚ùå **–ü–ª–æ—Ö–æ:**
```kotlin
fun getHistory() = repository.loadAll()  // –ö–∞–∂–¥—ã–π —Ä–∞–∑ –∏–∑ –ë–î - –º–µ–¥–ª–µ–Ω–Ω–æ!
```

### 4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

‚úÖ **–•–æ—Ä–æ—à–æ:**
```kotlin
// –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
if (request.message.isBlank()) {
    return ErrorResponse("–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
}

if (request.message.length > MAX_MESSAGE_LENGTH) {
    return ErrorResponse("–°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ")
}
```

‚ùå **–ü–ª–æ—Ö–æ:**
```kotlin
// –ë–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
repository.save(entry)  // –ú–æ–∂–µ—Ç –±—ã—Ç—å –º—É—Å–æ—Ä
```

### 5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

‚úÖ **–•–æ—Ä–æ—à–æ:**
```kotlin
logger.info("–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${entries.size} –∑–∞–ø–∏—Å–µ–π –∏–∑ –ø–∞–º—è—Ç–∏")
logger.debug("–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∑–∞–ø–∏—Å—å: ${entry.id}")
logger.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${e.message}", e)
```

‚ùå **–ü–ª–æ—Ö–æ:**
```kotlin
println("–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π")  // –ù–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Å–ª–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### 1. **Repository Pattern**

**–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:**
```
Domain Layer: MemoryRepository (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
    ‚Üì
Data Layer: SqliteMemoryRepository / JsonMemoryRepository (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
    ‚Üì
Storage: –ë–î/JSON —Ñ–∞–π–ª
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å domain –æ—Ç –¥–µ—Ç–∞–ª–µ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è
- –õ–µ–≥–∫–æ —Å–º–µ–Ω–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é (SQLite ‚Üí JSON)
- –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (–º–æ–∂–Ω–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π)

### 2. **Service Layer Pattern**

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –æ—Ç–¥–µ–ª–µ–Ω–∞ –æ—Ç —Ä–∞–±–æ—Ç—ã —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º:**
```
MemoryService
    ‚îú‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π (createUserEntry, createAssistantEntry)
    ‚îú‚îÄ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤ (toMessageDto, toMessageDtos)
    ‚îú‚îÄ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º (cachedHistory)
    ‚îî‚îÄ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è (loadHistory, saveEntries)
```

**MemoryRepository**
    ‚îî‚îÄ –¢–æ–ª—å–∫–æ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ (save, load, find, clear)

### 3. **Orchestrator Pattern**

**–ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –±–µ–∑ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏:**
```
MemoryOrchestrator
    ‚îú‚îÄ –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç MemoryService –∏ ConversationAgent
    ‚îú‚îÄ –£–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –¥–∏–∞–ª–æ–≥–∞
    ‚îî‚îÄ –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º/LLM
```

**–í–∞–∂–Ω–æ:** –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Ç–æ–ª—å–∫–æ –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç, –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ª–æ–≥–∏–∫—É!

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π –¥–∏–∞–ª–æ–≥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

```kotlin
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
orchestrator.initialize()  // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑ –ë–î

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
val response = orchestrator.handleMessage("–ü—Ä–∏–≤–µ—Ç!")

// –í–Ω—É—Ç—Ä–∏:
// 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑ –∫—ç—à–∞
// 2. –°–æ–∑–¥–∞–Ω–∏–µ userEntry
// 3. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ LLM —Å –∏—Å—Ç–æ—Ä–∏–µ–π
// 4. –°–æ–∑–¥–∞–Ω–∏–µ assistantEntry
// 5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–æ–∏—Ö –≤ –ë–î
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```kotlin
// –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ
main() {
    // ...
    orchestrator.initialize()  // –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∏–∑ –ë–î
    // ...
}

// –ò—Å—Ç–æ—Ä–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!
orchestrator.getHistory()  // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
```

### –ü—Ä–∏–º–µ—Ä 3: –°–±—Ä–æ—Å –ø–∞–º—è—Ç–∏

```kotlin
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–°–±—Ä–æ—Å–∏—Ç—å"
orchestrator.reset()

// –í–Ω—É—Ç—Ä–∏:
// 1. memoryService.clear()
// 2. repository.clear()  // DELETE FROM memory_entries
// 3. cachedHistory = emptyList()
```

---

## –ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **–í–Ω–µ—à–Ω—è—è –ø–∞–º—è—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞** –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π —Å LLM
2. **SQLite** ‚Äî –ª—É—á—à–∏–π –≤—ã–±–æ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å)
3. **JSON** ‚Äî —É–¥–æ–±–µ–Ω –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ø—Ä–æ—Å—Ç–æ—Ç–∞, —á–∏—Ç–∞–µ–º–æ—Å—Ç—å)
4. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
5. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏
6. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (Repository, Service, Orchestrator)

---

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
- –ò–∑—É—á–∏—Ç–µ [ARCHITECTURE.md](./ARCHITECTURE.md) –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–¥–∞
- –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ [README.md](./README.md) –¥–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø–æ –∑–∞–ø—É—Å–∫—É
- –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ –ø–∞–º—è—Ç–∏

