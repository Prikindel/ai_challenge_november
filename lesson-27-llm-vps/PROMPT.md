# –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: üî• –î–µ–Ω—å 27. –õ–æ–∫–∞–ª—å–Ω–∞—è LLM –Ω–∞ VPS

–¢—ã ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —Å–æ–∑–¥–∞—é—â–∏–π —É—Ä–æ–∫ ¬´üî• –î–µ–Ω—å 27. –õ–æ–∫–∞–ª—å–Ω–∞—è LLM –Ω–∞ VPS¬ª –≤ –º–æ–¥—É–ª–µ `lesson-27-llm-vps`. –ë–∞–∑–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Ç–∞–∫–∞—è –∂–µ, –∫–∞–∫ –≤ –ø—Ä–æ—à–ª—ã—Ö —É—Ä–æ–∫–∞—Ö (Kotlin + Ktor + SQLite, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞ vanilla JS). –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –î–Ω—è 25/26 –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç–∞, –Ω–æ —Ç–µ–ø–µ—Ä—å LLM –∂–∏–≤—ë—Ç –Ω–∞ VPS.

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á

**–≠—Ç–æ—Ç –ø—Ä–æ–º–ø—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ–º—É—é —á–∞—Å—Ç—å (–∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è).**

**–†—É—á–Ω—ã–µ —à–∞–≥–∏ –Ω–∞ VPS** (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ nginx, firewall) –æ–ø–∏—Å–∞–Ω—ã –≤:
- `VPS_SETUP.md` ‚Äî –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–∞ VPS
- `README.md` ‚Äî –æ–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –ø–∞–π–ø–ª–∞–π–Ω

**–ê–≥–µ–Ω—Ç –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
- –î–æ—Ä–∞–±–æ—Ç–∫—É `LocalLLMClient` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ HTTPS –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ VPS
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ VPS

---

## üéØ –¶–µ–ª—å —É—Ä–æ–∫–∞

–ü–æ–¥–∫–ª—é—á–∏—Ç—å —á–∞—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∏–∑ –î–Ω—è 25/26) –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π LLM, —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–π –Ω–∞ VPS, —á–µ—Ä–µ–∑ HTTPS —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π.

### –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è

```
VPS —Å LLM (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω) ‚Üí –ü—Ä–æ–∫—Å–∏ (HTTPS + auth) ‚Üí –ö–ª–∏–µ–Ω—Ç (—É—Ä–æ–∫ 25/26) ‚Üí –û—Ç–≤–µ—Ç—ã –≤ —á–∞—Ç–µ
```

**–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ:**
- VPS —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (—Å–º. `VPS_SETUP.md`)
- Ollama –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ HTTPS-–ø—Ä–æ–∫—Å–∏
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ (basic –∏–ª–∏ bearer)

**–ó–∞–¥–∞—á–∞ –∞–≥–µ–Ω—Ç–∞:**
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å —á–∞—Ç-–∫–ª–∏–µ–Ω—Ç –∫ VPS-LLM
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É HTTPS –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –∫–ª–∏–µ–Ω—Ç
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É

---

## üìã –ü–æ—ç—Ç–∞–ø–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–º–∏—Ç—ã)

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**
- –ö–∞–∂–¥—ã–π –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–π —à–∞–≥ = –æ—Ç–¥–µ–ª—å–Ω—ã–π git-–∫–æ–º–º–∏—Ç.
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ **–°–¢–û–ü**, –ø–æ–∫–∞–∂–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –¥–æ–∂–¥–∏—Å—å ¬´–æ–∫, –ø—Ä–æ–¥–æ–ª–∂–∞–π¬ª.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –¥–µ–ª–∞–µ—Ç merge/commit –¥–∞–ª–µ–µ.

**–ü–†–ò–ú–ï–ß–ê–ù–ò–ï:** –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ VPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å–æ–≥–ª–∞—Å–Ω–æ `VPS_SETUP.md`.

---

### –ö–æ–º–º–∏—Ç 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ (—á–∞—Ç –∏–∑ –î–Ω—è 25/26)

**–ó–∞–¥–∞—á–∞:** –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫ VPS-LLM.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –û–±–Ω–æ–≤–∏—Ç—å `config/server.yaml` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥):
   ```yaml
   localLLM:
     enabled: true
     provider: "ollama"
     baseUrl: "https://185.31.165.227"
     model: "llama3.2"
     apiPath: "/api/generate"
     timeout: 120000
     auth:
       type: "basic"       # basic –∏–ª–∏ bearer
       user: "user"
       password: "pass"
       token: ""           # –µ—Å–ª–∏ bearer
   ```
2. –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å `LocalLLMClient`:
   - HTTPS
   - basic/bearer auth
   - –æ–±—Ä–∞–±–æ—Ç–∫–∞ 401/403/5xx, —Ç–∞–π–º–∞—É—Ç—ã, retries –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
3. –õ–æ–≥–∏: —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å, –∫ –∫–∞–∫–æ–º—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É –∏–¥—ë—Ç –∑–∞–ø—Ä–æ—Å.

**–ü–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞:** –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è.

---

### –ö–æ–º–º–∏—Ç 2: UI/–ø—Ä–æ–≤–∞–π–¥–µ—Ä –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

**–ó–∞–¥–∞—á–∞:** –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –æ—Ç–≤–µ—Ç—ã –∏–¥—É—Ç —Å VPS.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –í UI –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä: `local (vps: llama3.2)`.
2. –ï—Å–ª–∏ –µ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–∏—Ç—å VPS.
3. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É/–ª–µ–π–±–ª ¬´–û—Ç–≤–µ—Ç —Å VPS LLM¬ª.

**–ü–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞:** –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è.

---

### –ö–æ–º–º–∏—Ç 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ end-to-end

**–ó–∞–¥–∞—á–∞:** –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–∞—Ç –ø—Ä–æ—Ç–∏–≤ VPS-LLM.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –¢–µ—Å—Ç-–∫–µ–π—Å—ã:
   - –ö–æ—Ä–æ—Ç–∫–∏–π –≤–æ–ø—Ä–æ—Å ‚Üí –æ—Ç–≤–µ—Ç
   - –î–ª–∏–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç/—Ç–∞–π–º–∞—É—Ç (—Å—Ç—Ä–∏–º –∏–ª–∏ –¥–æ–ª–≥–∏–π –æ—Ç–≤–µ—Ç)
   - –û—à–∏–±–æ—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—É—é –æ—à–∏–±–∫—É)
2. –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `TESTING.md`.

**–ü–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞:** –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è.

---

### –ö–æ–º–º–∏—Ç 4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ó–∞–¥–∞—á–∞:** —Å–æ–±—Ä–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

**–î–µ–π—Å—Ç–≤–∏—è:**
1. `README.md`: –æ–±–∑–æ—Ä —É—Ä–æ–∫–∞, —à–∞–≥–∏ –¥–µ–ø–ª–æ—è, –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞ –∫–ª–∏–µ–Ω—Ç–∞.
2. `VPS_SETUP.md`: –ø–æ—à–∞–≥–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞, UFW, –ø—Ä–æ–∫—Å–∏, certbot, auth, –ø—Ä–∏–º–µ—Ä nginx/caddy.
3. `TESTING.md`: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã e2e.

**–ü–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞:** —Ñ–∏–Ω–∞–ª.

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (Ollama –Ω–∞ VPS)
```bash
curl -fsSL https://ollama.com/install.sh | sh
systemctl enable --now ollama
ollama pull llama3.2
ollama run llama3.2 "hello"
```

### –ü—Ä–∏–º–µ—Ä nginx (basic auth)
```
server {
  listen 80;
  server_name 185.31.165.227;
  return 301 https://$host$request_uri;
}

server {
  listen 443 ssl;
  server_name 185.31.165.227;

  ssl_certificate     /etc/letsencrypt/live/185.31.165.227/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/185.31.165.227/privkey.pem;

  auth_basic "LLM";
  auth_basic_user_file /etc/nginx/.htpasswd;

  location /api/ {
    proxy_pass http://127.0.0.1:11434/;
    proxy_set_header Host $host;
    proxy_read_timeout 300;
    proxy_send_timeout 300;
  }
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞
```bash
curl https://185.31.165.227/api/generate \
  -u user:pass \
  -H "Content-Type: application/json" \
  -d '{"model":"llama3.2","prompt":"–ü—Ä–∏–≤–µ—Ç!","stream":false}'
```

## –†–∏—Å–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ù–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø–æ—Ä—Ç 11434 –Ω–∞—Ä—É–∂—É; —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ HTTPS-–ø—Ä–æ–∫—Å–∏ —Å auth.
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ HTTPS (Let‚Äôs Encrypt) + auth (basic/bearer).
- –¢–∞–π–º–∞—É—Ç—ã –∏ –ª–∏–º–∏—Ç—ã body-size –Ω–∞ –ø—Ä–æ–∫—Å–∏; –ª–æ–≥-—Ä–æ—Ç–∞—Ü–∏—è.
- –°–ª–µ–¥–∏—Ç—å –∑–∞ —Ä–µ—Å—É—Ä—Å–∞–º–∏ (CPU/RAM/GPU) –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ ‚Äî —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å llama.cpp server —Å `--api` –∏–ª–∏ text-generation-inference.

