# üî• –î–µ–Ω—å 22. –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç RAG –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤ FAQ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, —á–µ—Ä–µ–∑ MCP –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ —Ç–∏–∫–µ—Ç–µ –∏–∑ CRM –∏ –≤—ã–¥–∞—ë—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Å —É—á—ë—Ç–æ–º –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π.

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

> üìπ [–í–∏–¥–µ–æ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç—É—Ç](https://disk.yandex.ru/i/Nidb3Qf4Koo-pQ)

**–°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ UI
2. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (project/docs/support/)
3. –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–ü–æ–¥–¥–µ—Ä–∂–∫–∞"
4. –£–∫–∞–∑–∞–Ω–∏–µ User ID –∏ Ticket ID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –ó–∞–¥–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–µ
6. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —Å —É—á—ë—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ç–∏–∫–µ—Ç–∞ –∏ RAG-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
7. –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
8. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏)
9. –≠–∫—Å–ø–æ—Ä—Ç –¥–∏–∞–ª–æ–≥–∞ –≤ JSON –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã:
- –ö–æ–ø–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –∏–∑ —É—Ä–æ–∫–∞ 21 (RAG, MCP, Git –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
- –°–æ–∑–¥–∞—ë–º **CRM MCP —Å–µ—Ä–≤–µ—Ä** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ç–∏–∫–µ—Ç–∞–º–∏:
  - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `get_user` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID –∏–ª–∏ email
  - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `get_ticket` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞ –ø–æ ID
  - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `get_user_tickets` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `create_ticket` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–∏–∫–µ—Ç–∞
  - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `add_ticket_message` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–∏–∫–µ—Ç
- –°–æ–∑–¥–∞—ë–º **SupportService** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤:
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ CRM MCP
  - –ü–æ–∏—Å–∫ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ RAG
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ LLM —Å —É—á—ë—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –°–æ–∑–¥–∞—ë–º **SupportPromptBuilder** –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- –†–µ–∞–ª–∏–∑—É–µ–º **API endpoints** –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏:
  - `POST /api/support/ask` ‚Äî –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ–¥–¥–µ—Ä–∂–∫–µ
  - `GET /api/support/ticket/{ticketId}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–∫–µ—Ç–µ
  - `GET /api/support/user/{userId}/tickets` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Ç–∏–∫–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `POST /api/support/ticket` ‚Äî —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–∏–∫–µ—Ç
  - `POST /api/support/ticket/{ticketId}/message` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- –°–æ–∑–¥–∞—ë–º **UI –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏**:
  - –§–æ—Ä–º–∞ –¥–ª—è –≤–≤–æ–¥–∞ –≤–æ–ø—Ä–æ—Å–∞
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞–º–∏ (—Å–ø–∏—Å–æ–∫, —Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä)
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏
  - –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞
  - –≠–∫—Å–ø–æ—Ä—Ç –¥–∏–∞–ª–æ–≥–∞
- –î–æ–±–∞–≤–ª—è–µ–º **–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é FAQ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏** –¥–ª—è RAG-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

## üéØ –ü–∞–π–ø–ª–∞–π–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```
–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  ‚Üì
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ CRM MCP:
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (get_user)
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∏–∫–µ—Ç–µ (get_ticket, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
  - –ò—Å—Ç–æ—Ä–∏—è —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (get_user_tickets)
  ‚Üì
–ü–æ–∏—Å–∫ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ RAG (rag_search_project_docs):
  - –§–∏–ª—å—Ç—Ä: project/docs/support/
  - –ü–æ–∏—Å–∫ –≤ FAQ, troubleshooting, user guide, auth guide
  ‚Üì
–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (SupportPromptBuilder):
  - –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å —Ä–æ–ª—å—é support agent
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç —Å –≤–æ–ø—Ä–æ—Å–æ–º, –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º —Ç–∏–∫–µ—Ç–∞ –∏ RAG-–∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
  ‚Üì
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ LLM (LLMService)
  ‚Üì
–í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: –æ—Ç–≤–µ—Ç, –∏—Å—Ç–æ—á–Ω–∏–∫–∏, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
lesson-22-support-assistant/
‚îú‚îÄ‚îÄ config/server.yaml
‚îú‚îÄ‚îÄ data/knowledge_base.db    # –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π + —á–∞—Ç
‚îú‚îÄ‚îÄ documents/                # –î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ project/                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ support/          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ faq.md        # FAQ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ troubleshooting.md
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user-guide.md
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth-guide.md
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.md
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.md
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ crm-mcp-server/           # MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å CRM
‚îÇ   ‚îî‚îÄ‚îÄ src/main/kotlin/com/prike/crmmcpserver/
‚îÇ       ‚îú‚îÄ‚îÄ Main.kt
‚îÇ       ‚îú‚îÄ‚îÄ model/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ User.kt
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ Ticket.kt
‚îÇ       ‚îú‚îÄ‚îÄ storage/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ InMemoryCRMStorage.kt
‚îÇ       ‚îú‚îÄ‚îÄ server/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ CRMMCPServer.kt
‚îÇ       ‚îî‚îÄ‚îÄ tools/
‚îÇ           ‚îú‚îÄ‚îÄ GetUserTool.kt
‚îÇ           ‚îú‚îÄ‚îÄ GetTicketTool.kt
‚îÇ           ‚îú‚îÄ‚îÄ GetUserTicketsTool.kt
‚îÇ           ‚îú‚îÄ‚îÄ CreateTicketTool.kt
‚îÇ           ‚îî‚îÄ‚îÄ AddTicketMessageTool.kt
‚îú‚îÄ‚îÄ git-mcp-server/           # MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å git
‚îú‚îÄ‚îÄ rag-mcp-server/           # MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è RAG
‚îÇ   ‚îî‚îÄ‚îÄ service/
‚îÇ       ‚îî‚îÄ‚îÄ DocumentIndexer.kt  # –æ–±–Ω–æ–≤–ª—ë–Ω: indexSupportDocs()
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îî‚îÄ‚îÄ src/main/kotlin/com/prike/
‚îÇ       ‚îú‚îÄ‚îÄ data/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ client/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GitMCPClient.kt
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RagMCPClient.kt
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CRMMCPClient.kt  # –Ω–æ–≤—ã–π: –∫–ª–∏–µ–Ω—Ç –¥–ª—è CRM MCP
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ repository/
‚îÇ       ‚îú‚îÄ‚îÄ domain/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ model/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SupportModels.kt  # –Ω–æ–≤—ã–π: –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ service/
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ SupportService.kt  # –Ω–æ–≤—ã–π: —Å–µ—Ä–≤–∏—Å –ø–æ–¥–¥–µ—Ä–∂–∫–∏
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ SupportPromptBuilder.kt  # –Ω–æ–≤—ã–π: –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –ø—Ä–æ–º–ø—Ç–æ–≤
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ CRMMCPService.kt  # –Ω–æ–≤—ã–π: —Å–µ—Ä–≤–∏—Å CRM MCP
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ GitMCPService.kt
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ RagMCPService.kt
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ LLMService.kt
‚îÇ       ‚îî‚îÄ‚îÄ presentation/
‚îÇ           ‚îú‚îÄ‚îÄ controller/
‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ SupportController.kt  # –Ω–æ–≤—ã–π: API –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ           ‚îî‚îÄ‚îÄ dto/
‚îÇ               ‚îî‚îÄ‚îÄ SupportDtos.kt  # –Ω–æ–≤—ã–π: DTO –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
‚îî‚îÄ‚îÄ client/                # –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å (Vanilla JS)
    ‚îú‚îÄ‚îÄ support.html       # –Ω–æ–≤—ã–π: —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
    ‚îú‚îÄ‚îÄ support.js         # –Ω–æ–≤—ã–π: –ª–æ–≥–∏–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
    ‚îî‚îÄ‚îÄ ...
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Java 17+
- Gradle 8+
- Ollama (–¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤)
- OpenRouter API –∫–ª—é—á (–¥–ª—è LLM)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —É—Ä–æ–∫–∞:**
   ```bash
   cd lesson-22-support-assistant
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   cp example.env .env
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ —É–∫–∞–∂–∏—Ç–µ OPENAI_API_KEY
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Ollama (–¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤):**
   ```bash
   ollama serve
   ollama pull nomic-embed-text
   ```

4. **–°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   cd server
   ./gradlew build
   ./gradlew run
   ```

5. **–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:**
   ```
   http://localhost:8080
   ```

6. **–ò–Ω–¥–µ–∫—Å–∏—Ä—É–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ–¥–¥–µ—Ä–∂–∫–∏:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è"
   - –ù–∞–∂–º–∏—Ç–µ "–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ–¥–¥–µ—Ä–∂–∫–∏"

7. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–ü–æ–¥–¥–µ—Ä–∂–∫–∞"
   - –£–∫–∞–∂–∏—Ç–µ User ID –∏ Ticket ID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å
   - –ü–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç —Å —É—á—ë—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ–¥–¥–µ—Ä–∂–∫–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É "–ü–æ–¥–¥–µ—Ä–∂–∫–∞"
2. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–∫–∞–∂–∏—Ç–µ Ticket ID –¥–ª—è —Å–≤—è–∑–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ç–∏–∫–µ—Ç–æ–º
3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–∫–∞–∂–∏—Ç–µ User ID –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å
5. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å"
6. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç, –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞–º–∏

1. **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–∏–∫–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - –í–≤–µ–¥–∏—Ç–µ User ID –≤ –ø–æ–ª–µ "User ID –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤"
   - –ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–∏–∫–µ—Ç—ã"
   - –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —Ç–∏–∫–µ—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–æ–∏—Å–∫–æ–º

2. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–∏–∫–µ—Ç:**
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å —Ç–∏–∫–µ—Ç"
   - –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É (User ID, —Ç–µ–º–∞, –æ–ø–∏—Å–∞–Ω–∏–µ)
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å —Ç–∏–∫–µ—Ç"
   - –¢–∏–∫–µ—Ç –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω, –∏ —Ñ–æ—Ä–º–∞ –≤–æ–ø—Ä–æ—Å–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

3. **–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ç–∏–∫–µ—Ç–∞:**
   - –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ç–∏–∫–µ—Ç –≤ —Å–ø–∏—Å–∫–µ
   - –ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ Ticket ID –≤ —Ñ–æ—Ä–º–µ –≤–æ–ø—Ä–æ—Å–∞
   - –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

4. **–≠–∫—Å–ø–æ—Ä—Ç –¥–∏–∞–ª–æ–≥–∞:**
   - –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ç–∏–∫–µ—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω—ã –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
   - **JSON** ‚Äî –ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
   - **–¢–µ–∫—Å—Ç** ‚Äî —á–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –∏—Å—Ç–æ—Ä–∏–µ–π

### –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤:
- "–ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è?"
- "–ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å?"
- "–ö–∞–∫ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É?"
- "–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —Å–∞–π—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è?"
- "–ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å email?"
- "–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é?"

–ö–ª–∏–∫ –ø–æ –ø—Ä–∏–º–µ—Ä—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–µ –≤–æ–ø—Ä–æ—Å–∞.

## üîß API Endpoints

### POST /api/support/ask

–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ–¥–¥–µ—Ä–∂–∫–µ.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "ticketId": "ticket-123",
  "userId": "user-456",
  "question": "–ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è?"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "answer": "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å email –∏ –ø–∞—Ä–æ–ª—è. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å.",
  "sources": [
    {
      "title": "FAQ - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è",
      "content": "–ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è? –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å email –∏ –ø–∞—Ä–æ–ª—è...",
      "url": "/docs/support/faq.md"
    }
  ],
  "suggestions": [
    "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å",
    "–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞"
  ],
  "ticketId": "ticket-123",
  "shouldCreateTicket": false
}
```

### GET /api/support/ticket/{ticketId}

–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–∫–µ—Ç–µ —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π.

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": "ticket-123",
  "userId": "user-456",
  "subject": "–ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π",
  "description": "–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç",
  "status": "OPEN",
  "priority": "HIGH",
  "messages": [
    {
      "id": "msg-1",
      "ticketId": "ticket-123",
      "author": "user",
      "content": "–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç",
      "timestamp": 1234567890
    },
    {
      "id": "msg-2",
      "ticketId": "ticket-123",
      "author": "support",
      "content": "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å email –∏ –ø–∞—Ä–æ–ª—è...",
      "timestamp": 1234567891
    }
  ],
  "createdAt": 1234567890,
  "updatedAt": 1234567891
}
```

### GET /api/support/user/{userId}/tickets

–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–∏–∫–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–û—Ç–≤–µ—Ç:**
```json
{
  "tickets": [
    {
      "id": "ticket-123",
      "userId": "user-456",
      "subject": "–ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π",
      "status": "OPEN",
      "priority": "HIGH",
      "messageCount": 2,
      "createdAt": 1234567890,
      "updatedAt": 1234567891
    }
  ]
}
```

### POST /api/support/ticket

–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–∏–∫–µ—Ç.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "userId": "user-456",
  "subject": "–ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π",
  "description": "–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç"
}
```

**–û—Ç–≤–µ—Ç:** `TicketWithMessagesDto` (201 Created)

### POST /api/support/ticket/{ticketId}/message

–î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–∏–∫–µ—Ç.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "author": "user",
  "content": "–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–º–æ—â—å!"
}
```

**–û—Ç–≤–µ—Ç:** `TicketMessageDto` (201 Created)

## üé® –°—Ç–∞—Ç—É—Å—ã —Ç–∏–∫–µ—Ç–æ–≤

- **OPEN** ‚Äî –æ—Ç–∫—Ä—ã—Ç (–∂—ë–ª—Ç—ã–π)
- **IN_PROGRESS** ‚Äî –≤ —Ä–∞–±–æ—Ç–µ (—Å–∏–Ω–∏–π)
- **RESOLVED** ‚Äî —Ä–µ—à—ë–Ω (–∑–µ–ª—ë–Ω—ã–π)
- **CLOSED** ‚Äî –∑–∞–∫—Ä—ã—Ç (—Å–µ—Ä—ã–π)

## üö® –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ç–∏–∫–µ—Ç–æ–≤

- **LOW** ‚Äî –Ω–∏–∑–∫–∏–π
- **MEDIUM** ‚Äî —Å—Ä–µ–¥–Ω–∏–π
- **HIGH** ‚Äî –≤—ã—Å–æ–∫–∏–π
- **URGENT** ‚Äî —Å—Ä–æ—á–Ω—ã–π

## üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

–í `config/server.yaml` –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏:

```yaml
indexing:
  supportDocsPath: "project/docs/support"  # –ü–∞–ø–∫–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏
```

### CRM MCP —Å–µ—Ä–≤–µ—Ä

–í `config/server.yaml` –Ω–∞—Å—Ç—Ä–æ–µ–Ω CRM MCP —Å–µ—Ä–≤–µ—Ä:

```yaml
crm:
  mcp:
    enabled: true
    jarPath: "crm-mcp-server/build/libs/crm-mcp-server-1.0.0.jar"
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM —á–µ—Ä–µ–∑ MCP

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CRM MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –∏ —Ç–∏–∫–µ—Ç–∞—Ö:

- `get_user(userId, email)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `get_ticket(ticketId)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞
- `get_user_tickets(userId)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `create_ticket(userId, subject, description)` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞
- `add_ticket_message(ticketId, author, content)` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- [THEORY.md](./THEORY.md) ‚Äî —Ç–µ–æ—Ä–∏—è –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [PROMPT.md](./PROMPT.md) ‚Äî –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- [CHAT_PROMPT.txt](./CHAT_PROMPT.txt) ‚Äî –ø—Ä–æ–º–ø—Ç –¥–ª—è —á–∞—Ç–∞

## ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞—á—ë—Ç–∞

- ‚úÖ RAG –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤ FAQ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- ‚úÖ MCP –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å CRM (–ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ —Ç–∏–∫–µ—Ç–µ)
- ‚úÖ –û—Ç–≤–µ—Ç—ã —Å —É—á—ë—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ç–∏–∫–µ—Ç–∞
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏)

## üéì –ß—Ç–æ –º—ã –∏–∑—É—á–∏–ª–∏

1. **–°–æ–∑–¥–∞–Ω–∏–µ CRM MCP —Å–µ—Ä–≤–µ—Ä–∞** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ç–∏–∫–µ—Ç–∞–º–∏
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RAG –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏** ‚Äî –ø–æ–∏—Å–∫ –æ—Ç–≤–µ—Ç–æ–≤ –≤ FAQ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
3. **–ö–æ–Ω—Ç–µ–∫—Å—Ç —Ç–∏–∫–µ—Ç–∞** ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ —Å —É—á—ë—Ç–æ–º –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π
4. **SupportService** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π CRM –∏ RAG
5. **UI –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —É–¥–æ–±–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
6. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞–º–∏** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —ç–∫—Å–ø–æ—Ä—Ç
